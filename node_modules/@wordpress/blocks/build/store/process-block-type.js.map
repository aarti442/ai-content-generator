{"version":3,"names":["_isPlainObject","require","_reactIs","_deprecated","_interopRequireDefault","_hooks","_warning","_utils","_constants","LEGACY_CATEGORY_MAPPING","common","formatting","layout","mergeBlockVariations","bootstrappedVariations","clientVariations","result","forEach","clientVariation","index","findIndex","bootstrappedVariation","name","push","stabilizeSupportConfig","unstableConfig","stableSupportKey","stableConfig","key","value","Object","entries","_ref","_EXPERIMENTAL_SUPPORT","stableKey","EXPERIMENTAL_SUPPORT_PROPERTIES","COMMON_EXPERIMENTAL_PROPERTIES","__experimentalSkipSerialization","stabilizeSupports","rawSupports","newSupports","done","support","config","_EXPERIMENTAL_SUPPORT2","EXPERIMENTAL_SUPPORTS_MAP","isPlainObject","keys","every","hasOwn","_keyPositions$support","_keyPositions$stableS","keyPositions","reduce","acc","experimentalFirst","Number","MAX_VALUE","processBlockType","blockSettings","select","bootstrappedBlockType","getBootstrappedBlockType","blockType","icon","BLOCK_ICON_DEFAULT","keywords","attributes","providesContext","usesContext","selectors","supports","styles","blockHooks","save","variations","Array","isArray","settings","applyFilters","description","deprecated","since","map","deprecation","filteredDeprecation","omit","DEPRECATED_ENTRY_KEYS","fromEntries","filter","includes","globalThis","SCRIPT_DEBUG","warning","isValidElementType","edit","hasOwnProperty","category","getCategories","some","slug","title","normalizeIconObject","isValidIcon","src","parent","String","undefined","length","exports"],"sources":["@wordpress/blocks/src/store/process-block-type.js"],"sourcesContent":["/**\n * External dependencies\n */\nimport { isPlainObject } from 'is-plain-object';\nimport { isValidElementType } from 'react-is';\n\n/**\n * WordPress dependencies\n */\nimport deprecated from '@wordpress/deprecated';\nimport { applyFilters } from '@wordpress/hooks';\nimport warning from '@wordpress/warning';\n\n/**\n * Internal dependencies\n */\nimport { isValidIcon, normalizeIconObject, omit } from '../api/utils';\nimport {\n\tBLOCK_ICON_DEFAULT,\n\tDEPRECATED_ENTRY_KEYS,\n\tEXPERIMENTAL_SUPPORTS_MAP,\n\tCOMMON_EXPERIMENTAL_PROPERTIES,\n\tEXPERIMENTAL_SUPPORT_PROPERTIES,\n} from '../api/constants';\n\n/** @typedef {import('../api/registration').WPBlockType} WPBlockType */\n\n/**\n * Mapping of legacy category slugs to their latest normal values, used to\n * accommodate updates of the default set of block categories.\n *\n * @type {Record<string,string>}\n */\nconst LEGACY_CATEGORY_MAPPING = {\n\tcommon: 'text',\n\tformatting: 'text',\n\tlayout: 'design',\n};\n\n/**\n * Merge block variations bootstrapped from the server and client.\n *\n * When a variation is registered in both places, its properties are merged.\n *\n * @param {Array} bootstrappedVariations - A block type variations from the server.\n * @param {Array} clientVariations       - A block type variations from the client.\n * @return {Array} The merged array of block variations.\n */\nfunction mergeBlockVariations(\n\tbootstrappedVariations = [],\n\tclientVariations = []\n) {\n\tconst result = [ ...bootstrappedVariations ];\n\n\tclientVariations.forEach( ( clientVariation ) => {\n\t\tconst index = result.findIndex(\n\t\t\t( bootstrappedVariation ) =>\n\t\t\t\tbootstrappedVariation.name === clientVariation.name\n\t\t);\n\n\t\tif ( index !== -1 ) {\n\t\t\tresult[ index ] = { ...result[ index ], ...clientVariation };\n\t\t} else {\n\t\t\tresult.push( clientVariation );\n\t\t}\n\t} );\n\n\treturn result;\n}\n\n/**\n * Stabilizes a block support configuration by converting experimental properties\n * to their stable equivalents.\n *\n * @param {Object} unstableConfig   The support configuration to stabilize.\n * @param {string} stableSupportKey The stable support key for looking up properties.\n * @return {Object} The stabilized support configuration.\n */\nfunction stabilizeSupportConfig( unstableConfig, stableSupportKey ) {\n\tconst stableConfig = {};\n\tfor ( const [ key, value ] of Object.entries( unstableConfig ) ) {\n\t\t// Get stable key from support-specific map, common properties map, or keep original.\n\t\tconst stableKey =\n\t\t\tEXPERIMENTAL_SUPPORT_PROPERTIES[ stableSupportKey ]?.[ key ] ??\n\t\t\tCOMMON_EXPERIMENTAL_PROPERTIES[ key ] ??\n\t\t\tkey;\n\n\t\tstableConfig[ stableKey ] = value;\n\n\t\t/*\n\t\t * The `__experimentalSkipSerialization` key needs to be kept until\n\t\t * WP 6.8 becomes the minimum supported version. This is due to the\n\t\t * core `wp_should_skip_block_supports_serialization` function only\n\t\t * checking for `__experimentalSkipSerialization` in earlier versions.\n\t\t */\n\t\tif (\n\t\t\tkey === '__experimentalSkipSerialization' ||\n\t\t\tkey === 'skipSerialization'\n\t\t) {\n\t\t\tstableConfig.__experimentalSkipSerialization = value;\n\t\t}\n\t}\n\treturn stableConfig;\n}\n\n/**\n * Stabilizes experimental block supports by converting experimental keys and properties\n * to their stable equivalents.\n *\n * @param {Object|undefined} rawSupports The block supports configuration to stabilize.\n * @return {Object|undefined} The stabilized block supports configuration.\n */\nfunction stabilizeSupports( rawSupports ) {\n\tif ( ! rawSupports ) {\n\t\treturn rawSupports;\n\t}\n\n\t/*\n\t * Create a new object to avoid mutating the original. This ensures that\n\t * custom block plugins that rely on immutable supports are not affected.\n\t * See: https://github.com/WordPress/gutenberg/pull/66849#issuecomment-2463614281\n\t */\n\tconst newSupports = {};\n\tconst done = {};\n\n\tfor ( const [ support, config ] of Object.entries( rawSupports ) ) {\n\t\t/*\n\t\t * If this support config has already been stabilized, skip it.\n\t\t * A stable support key occurring after an experimental key, gets\n\t\t * stabilized then so that the two configs can be merged effectively.\n\t\t */\n\t\tif ( done[ support ] ) {\n\t\t\tcontinue;\n\t\t}\n\n\t\tconst stableSupportKey =\n\t\t\tEXPERIMENTAL_SUPPORTS_MAP[ support ] ?? support;\n\n\t\t/*\n\t\t * Use the support's config as is when it's not in need of stabilization.\n\t\t * A support does not need stabilization if:\n\t\t * - The support key doesn't need stabilization AND\n\t\t * - Either:\n\t\t *     - The config isn't an object, so can't have experimental properties OR\n\t\t *     - The config is an object but has no experimental properties to stabilize.\n\t\t */\n\t\tif (\n\t\t\tsupport === stableSupportKey &&\n\t\t\t( ! isPlainObject( config ) ||\n\t\t\t\t( ! EXPERIMENTAL_SUPPORT_PROPERTIES[ stableSupportKey ] &&\n\t\t\t\t\tObject.keys( config ).every(\n\t\t\t\t\t\t( key ) => ! COMMON_EXPERIMENTAL_PROPERTIES[ key ]\n\t\t\t\t\t) ) )\n\t\t) {\n\t\t\tnewSupports[ support ] = config;\n\t\t\tcontinue;\n\t\t}\n\n\t\t// Stabilize the config value.\n\t\tconst stableConfig = isPlainObject( config )\n\t\t\t? stabilizeSupportConfig( config, stableSupportKey )\n\t\t\t: config;\n\n\t\t/*\n\t\t * If a plugin overrides the support config with the `blocks.registerBlockType`\n\t\t * filter, both experimental and stable configs may be present. In that case,\n\t\t * use the order keys are defined in to determine the final value.\n\t\t *    - If config is an array, merge the arrays in their order of definition.\n\t\t *    - If config is not an array, use the value defined last.\n\t\t *\n\t\t * The reason for preferring the last defined key is that after filters\n\t\t * are applied, the last inserted key is likely the most up-to-date value.\n\t\t * We cannot determine with certainty which value was \"last modified\" so\n\t\t * the insertion order is the best guess. The extreme edge case of multiple\n\t\t * filters tweaking the same support property will become less over time as\n\t\t * extenders migrate existing blocks and plugins to stable keys.\n\t\t */\n\t\tif (\n\t\t\tsupport !== stableSupportKey &&\n\t\t\tObject.hasOwn( rawSupports, stableSupportKey )\n\t\t) {\n\t\t\tconst keyPositions = Object.keys( rawSupports ).reduce(\n\t\t\t\t( acc, key, index ) => {\n\t\t\t\t\tacc[ key ] = index;\n\t\t\t\t\treturn acc;\n\t\t\t\t},\n\t\t\t\t{}\n\t\t\t);\n\t\t\tconst experimentalFirst =\n\t\t\t\t( keyPositions[ support ] ?? Number.MAX_VALUE ) <\n\t\t\t\t( keyPositions[ stableSupportKey ] ?? Number.MAX_VALUE );\n\n\t\t\tif ( isPlainObject( rawSupports[ stableSupportKey ] ) ) {\n\t\t\t\t/*\n\t\t\t\t * To merge the alternative support config effectively, it also needs to be\n\t\t\t\t * stabilized before merging to keep stabilized and experimental flags in sync.\n\t\t\t\t */\n\t\t\t\trawSupports[ stableSupportKey ] = stabilizeSupportConfig(\n\t\t\t\t\trawSupports[ stableSupportKey ],\n\t\t\t\t\tstableSupportKey\n\t\t\t\t);\n\t\t\t\tnewSupports[ stableSupportKey ] = experimentalFirst\n\t\t\t\t\t? { ...stableConfig, ...rawSupports[ stableSupportKey ] }\n\t\t\t\t\t: { ...rawSupports[ stableSupportKey ], ...stableConfig };\n\t\t\t\t// Prevents reprocessing this support as it was merged above.\n\t\t\t\tdone[ stableSupportKey ] = true;\n\t\t\t} else {\n\t\t\t\tnewSupports[ stableSupportKey ] = experimentalFirst\n\t\t\t\t\t? rawSupports[ stableSupportKey ]\n\t\t\t\t\t: stableConfig;\n\t\t\t}\n\t\t} else {\n\t\t\tnewSupports[ stableSupportKey ] = stableConfig;\n\t\t}\n\t}\n\n\treturn newSupports;\n}\n\n/**\n * Takes the unprocessed block type settings, merges them with block type metadata\n * and applies all the existing filters for the registered block type.\n * Next, it validates all the settings and performs additional processing to the block type definition.\n *\n * @param {string}      name          Block name.\n * @param {WPBlockType} blockSettings Unprocessed block type settings.\n *\n * @return {WPBlockType | undefined} The block, if it has been processed and can be registered; otherwise `undefined`.\n */\nexport const processBlockType =\n\t( name, blockSettings ) =>\n\t( { select } ) => {\n\t\tconst bootstrappedBlockType = select.getBootstrappedBlockType( name );\n\n\t\tconst blockType = {\n\t\t\tname,\n\t\t\ticon: BLOCK_ICON_DEFAULT,\n\t\t\tkeywords: [],\n\t\t\tattributes: {},\n\t\t\tprovidesContext: {},\n\t\t\tusesContext: [],\n\t\t\tselectors: {},\n\t\t\tsupports: {},\n\t\t\tstyles: [],\n\t\t\tblockHooks: {},\n\t\t\tsave: () => null,\n\t\t\t...bootstrappedBlockType,\n\t\t\t...blockSettings,\n\t\t\t// blockType.variations can be defined as a filePath.\n\t\t\tvariations: mergeBlockVariations(\n\t\t\t\tArray.isArray( bootstrappedBlockType?.variations )\n\t\t\t\t\t? bootstrappedBlockType.variations\n\t\t\t\t\t: [],\n\t\t\t\tArray.isArray( blockSettings?.variations )\n\t\t\t\t\t? blockSettings.variations\n\t\t\t\t\t: []\n\t\t\t),\n\t\t};\n\n\t\t// Stabilize any experimental supports before applying filters.\n\t\tblockType.supports = stabilizeSupports( blockType.supports );\n\n\t\tconst settings = applyFilters(\n\t\t\t'blocks.registerBlockType',\n\t\t\tblockType,\n\t\t\tname,\n\t\t\tnull\n\t\t);\n\n\t\t// Re-stabilize any experimental supports after applying filters.\n\t\t// This ensures that any supports updated by filters are also stabilized.\n\t\tblockType.supports = stabilizeSupports( blockType.supports );\n\n\t\tif (\n\t\t\tsettings.description &&\n\t\t\ttypeof settings.description !== 'string'\n\t\t) {\n\t\t\tdeprecated( 'Declaring non-string block descriptions', {\n\t\t\t\tsince: '6.2',\n\t\t\t} );\n\t\t}\n\n\t\tif ( settings.deprecated ) {\n\t\t\tsettings.deprecated = settings.deprecated.map( ( deprecation ) => {\n\t\t\t\t// Stabilize any experimental supports before applying filters.\n\t\t\t\tlet filteredDeprecation = {\n\t\t\t\t\t...deprecation,\n\t\t\t\t\tsupports: stabilizeSupports( deprecation.supports ),\n\t\t\t\t};\n\n\t\t\t\tfilteredDeprecation = // Only keep valid deprecation keys.\n\t\t\t\t\tapplyFilters(\n\t\t\t\t\t\t'blocks.registerBlockType',\n\t\t\t\t\t\t// Merge deprecation keys with pre-filter settings\n\t\t\t\t\t\t// so that filters that depend on specific keys being\n\t\t\t\t\t\t// present don't fail.\n\t\t\t\t\t\t{\n\t\t\t\t\t\t\t// Omit deprecation keys here so that deprecations\n\t\t\t\t\t\t\t// can opt out of specific keys like \"supports\".\n\t\t\t\t\t\t\t...omit( blockType, DEPRECATED_ENTRY_KEYS ),\n\t\t\t\t\t\t\t...filteredDeprecation,\n\t\t\t\t\t\t},\n\t\t\t\t\t\tblockType.name,\n\t\t\t\t\t\tfilteredDeprecation\n\t\t\t\t\t);\n\t\t\t\t// Re-stabilize any experimental supports after applying filters.\n\t\t\t\t// This ensures that any supports updated by filters are also stabilized.\n\t\t\t\tfilteredDeprecation.supports = stabilizeSupports(\n\t\t\t\t\tfilteredDeprecation.supports\n\t\t\t\t);\n\n\t\t\t\treturn Object.fromEntries(\n\t\t\t\t\tObject.entries( filteredDeprecation ).filter( ( [ key ] ) =>\n\t\t\t\t\t\tDEPRECATED_ENTRY_KEYS.includes( key )\n\t\t\t\t\t)\n\t\t\t\t);\n\t\t\t} );\n\t\t}\n\n\t\tif ( ! isPlainObject( settings ) ) {\n\t\t\twarning( 'Block settings must be a valid object.' );\n\t\t\treturn;\n\t\t}\n\n\t\tif ( typeof settings.save !== 'function' ) {\n\t\t\twarning( 'The \"save\" property must be a valid function.' );\n\t\t\treturn;\n\t\t}\n\t\tif ( 'edit' in settings && ! isValidElementType( settings.edit ) ) {\n\t\t\twarning( 'The \"edit\" property must be a valid component.' );\n\t\t\treturn;\n\t\t}\n\n\t\t// Canonicalize legacy categories to equivalent fallback.\n\t\tif ( LEGACY_CATEGORY_MAPPING.hasOwnProperty( settings.category ) ) {\n\t\t\tsettings.category = LEGACY_CATEGORY_MAPPING[ settings.category ];\n\t\t}\n\n\t\tif (\n\t\t\t'category' in settings &&\n\t\t\t! select\n\t\t\t\t.getCategories()\n\t\t\t\t.some( ( { slug } ) => slug === settings.category )\n\t\t) {\n\t\t\twarning(\n\t\t\t\t'The block \"' +\n\t\t\t\t\tname +\n\t\t\t\t\t'\" is registered with an invalid category \"' +\n\t\t\t\t\tsettings.category +\n\t\t\t\t\t'\".'\n\t\t\t);\n\t\t\tdelete settings.category;\n\t\t}\n\n\t\tif ( ! ( 'title' in settings ) || settings.title === '' ) {\n\t\t\twarning( 'The block \"' + name + '\" must have a title.' );\n\t\t\treturn;\n\t\t}\n\t\tif ( typeof settings.title !== 'string' ) {\n\t\t\twarning( 'Block titles must be strings.' );\n\t\t\treturn;\n\t\t}\n\n\t\tsettings.icon = normalizeIconObject( settings.icon );\n\t\tif ( ! isValidIcon( settings.icon.src ) ) {\n\t\t\twarning(\n\t\t\t\t'The icon passed is invalid. ' +\n\t\t\t\t\t'The icon should be a string, an element, a function, or an object following the specifications documented in https://developer.wordpress.org/block-editor/developers/block-api/block-registration/#icon-optional'\n\t\t\t);\n\t\t\treturn;\n\t\t}\n\n\t\tif (\n\t\t\ttypeof settings?.parent === 'string' ||\n\t\t\tsettings?.parent instanceof String\n\t\t) {\n\t\t\tsettings.parent = [ settings.parent ];\n\t\t\twarning(\n\t\t\t\t'Parent must be undefined or an array of strings (block types), but it is a string.'\n\t\t\t);\n\t\t\t// Intentionally continue:\n\t\t\t//\n\t\t\t// While string values were never supported, they appeared to work with some unintended side-effects\n\t\t\t// that have been fixed by [#66250](https://github.com/WordPress/gutenberg/pull/66250).\n\t\t\t//\n\t\t\t// To be backwards-compatible, this code that automatically migrates strings to arrays.\n\t\t}\n\n\t\tif (\n\t\t\t! Array.isArray( settings?.parent ) &&\n\t\t\tsettings?.parent !== undefined\n\t\t) {\n\t\t\twarning(\n\t\t\t\t'Parent must be undefined or an array of block types, but it is ',\n\t\t\t\tsettings.parent\n\t\t\t);\n\t\t\treturn;\n\t\t}\n\n\t\tif ( 1 === settings?.parent?.length && name === settings.parent[ 0 ] ) {\n\t\t\twarning(\n\t\t\t\t'Block \"' +\n\t\t\t\t\tname +\n\t\t\t\t\t'\" cannot be a parent of itself. Please remove the block name from the parent list.'\n\t\t\t);\n\t\t\treturn;\n\t\t}\n\n\t\treturn settings;\n\t};\n"],"mappings":"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","ignoreList":[]}